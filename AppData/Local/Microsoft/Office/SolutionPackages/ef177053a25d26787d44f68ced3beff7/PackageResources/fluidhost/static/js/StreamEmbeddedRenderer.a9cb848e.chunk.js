"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[10835],{58724:(e,t,n)=>{n.r(t),n.d(t,{StreamEmbeddedRenderer:()=>$e});var r=n(72791);var i=n(96013),o=n(5769),a=n(39400),s=n(73562),l=n(71507),c=n(78339),d=n(69438),u=n(2701);const p="playerInteractiveTimestamp";function h(){return{setIsReady(e,t,n){const r=t.playerInteractiveTimestamp;if(r){const t=r.timestamp,i=r.timeOrigin,o=performance.timeOrigin,a=Math.abs(n-o),s=Math.round(e.startTime-a),l=t+i-n;e.setResult(!0,{timeDrift:Math.round(a),hostTimeOrigin:o,hostVariableTimeOrigin:n,activityStartTimeWithDrift:s,[p]:Math.round(t),playerInteractiveTimestamp_timeOrigin:Math.round(i),playerInteractiveTimestamp_currentTimeScale:Math.round(l),activityStartTimeMs_performanceNow:Math.round(e.startTime),unfurlDurationMs_performanceNow:Math.round(l-e.startTime)})}}}}var m=n(19426);function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.E.VideoLoadFromUnfurl;return e.activities.get(t)}const v=[" ","Enter"],y=[...v,"Tab"];function b(e){return"warmData"in e}function g(e){return"simulateClick"in e}var _=n(20203),w=n(97349),k=n(70897),E=n(55520),P="<safe>",S="</safe>";var T,I=(T="Unsupported browser","".concat(P).concat(T).concat(S));var A=function(){function e(e,t,n,r,i,o,a,s){this.level=e,this.isExpected=t,this.scenario=n,this.knownError=r,this.originalError=i,this.message=o,this.playbackSessionId=a,this.hostSessionId=s}return e.createKnownError=function(t,n,r,i,o,a,s,l){return new e(t,n,r,i,o,a,s,l)},e.createGenericError=function(t,n,r,i,o,a,s){var l=!1;if(null===i||void 0===i?void 0:i.isExpected)l=i.isExpected,o=i.errorName;else if(i&&i.message){var c=function(e){return"'ResizeObserver' is undefined"===e||"'ResizeObserver' is not defined"===e||"ResizeObserver is not defined"===e||"Can't find variable: ResizeObserver"===e||"'IntersectionObserver' is undefined"===e||"IntersectionObserver is not defined"===e||"Can't find variable: IntersectionObserver"===e||"'PerformanceObserver' is undefined"===e||"'PerformanceObserver' is not defined"===e||"function is not a constructor (evaluating 'new EventTarget')"===e||e===I||!(!e||!e.includes("setstrings"))||!(!e||!e.includes("URL is not supported"))||"e.addEventListener is not a function. (In 'e.addEventListener(\"change\",m)', 'e.addEventListener' is undefined)"===e||"Object doesn't support property or method 'addEventListener'"===e||"Performance timeOrigin is not supported"===e}(i.message);c&&(l=!0)}return e.createKnownError(t,l,n,r,i,o,a,s)},e}(),C=n(75971),O=function(e){this.willBeUnregistered=!1,this.unregisterOnNextCall=!1,this.callback=e},U=function(){function e(e){this._observers=new Array,this.onCallbackError=e}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var n=new O(e);return n.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(n),this.internalRemove.bind(this,n)},e.prototype.notify=function(e){for(var t=0,n=this._observers;t<n.length;t++){var r=n[t];if(!r.willBeUnregistered){try{r.callback(e)}catch(i){this.onCallbackError&&this.onCallbackError(i)}r.unregisterOnNextCall&&this.deferUnregister(r)}}},e.prototype.unsubscribeAll=function(){this._observers.length=0},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout((function(){t.internalRemove(e)}),0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}(),M=function(){function e(e,t){this._observable=new U(t),this._value=e,this.onCallbackError=t}return e.prototype.unsubscribeAll=function(){this._observable.unsubscribeAll()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t){var n=!(null===t||void 0===t?void 0:t.ignoreCurrentValue);if(n)try{e(this._value)}catch(r){this.onCallbackError&&this.onCallbackError(r)}return(null===t||void 0===t?void 0:t.unregisterOnFirstCall)&&n?function(){}:this._observable.subscribe(e,t)},e}(),R=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function x(e,t){var n=e,r=n.dispose,i="function"===typeof r&&r.disposalChain||function(e){var t=new R(e),n=e.dispose,r=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=r,r.disposalChain=t,t}(n);return i.addCallback(t),n}var D=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),r=x(e,(function(){delete t._disposables[n]}));return this._disposables[n]=r,r},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i&&"function"===typeof i.dispose&&i.dispose(),delete e[r]}},e}(),N=function(){function e(e){this._scope=new D,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var r;if(F(e))r=e;else{var i=this._targetMap.get(e);i?r=i:(r=new EventTarget,this._targetMap.set(e,r))}r.addEventListener(t,n);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var a=this._scope.attach({dispose:function(){r.removeEventListener(t,n)}});o.set(t,a)},e.prototype.off=function(e,t,n){var r;if(F(e))r=e;else{var i=this._targetMap.get(e);i&&(r=i)}var o=this._disposableMap.get(e);if(o){var a=o.get(t);a&&(a.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}r&&r.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function F(e){return!!e.addEventListener}var L=function(){function e(e){this._scope=new D,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,r=setTimeout((function(){n._timeoutMap.delete(r),e()}),t),i=this._scope.attach({dispose:function(){clearTimeout(r)}});return this._timeoutMap.set(r,i),r},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),V="unsupportedCommand",W="handlerError",G="handlerRejection",H="acknowledgeTimeout",j="resultTimeout",z="setupTimeout",B="canceled",K="disposed",X=0,J=function(){function e(e,t){void 0===t&&(t={});var n=this,r=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},o=e.initResources,a=e.initTimeoutMs,s=void 0===a?1e4:a,l=e.ackTimeoutMs,c=void 0===l?1e3:l,d=e.resultTimeoutMs,u=void 0===d?1e4:d,p=t.asyncType,h=void 0===p?L:p,m=t.eventGroupType,f=void 0===m?N:m,v=this._scope=new D;v.attach(o);var y,b=this._async=v.attach(new h(this)),g=v.attach(new f(this));this._ackTimeoutMs=c,this._resultTimeoutMs=u,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch((function(e){return{result:"error",error:{code:(e=e||{name:G,isExpected:!1,message:"Unknown error"}).code||e.name||G,message:e.message||"".concat(e)},isExpected:!!e.isExpected}})):Promise.resolve({result:"error",error:{code:V,message:e.command},isExpected:!0})}catch(n){return Promise.resolve({result:"error",isExpected:!1,error:{code:W,message:n&&"Name: ".concat(n.name,"; Message: ").concat(n.message||n)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(a){}};var _=this._port=new Promise((function(t,r){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=B,r(e)}}),y=b.setTimeout((function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code=z,r(e)}),s),e.init((function(e){b.clearTimeout(y),v.attach({dispose:function(){e.close()}});g.on(e,"message",(function(t){var r=t.data;if(r&&"object"===typeof r)return"acknowledge"===r.type?n._onAcknowledge(r):"command"===r.type?n._onCommand(e,r):"notification"===r.type?n._onNotification(r):"result"===r.type?n._onResult(r):void 0})),e.start(),t(e)}),r)}));this.ready=_.then((function(){}),(function(e){return n.dispose(),Promise.reject(e)})),this._signals=r}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach((function(e){e.resolve({result:"error",isExpected:!0,error:{code:B,message:"Messenger disposed"}})})),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:K,message:"disposed"}});var r=++X,i=t.timeoutDelayMs,o=void 0===i?this._resultTimeoutMs:i,a=t.acknowledgeTimeoutMs,s=void 0===a?this._ackTimeoutMs:a,l=t.transfer;return this._port.then((function(t){var i=n._async,a=new Promise((function(e){n._signals.set(r,{acknowledgeTimeout:i.setTimeout((function(){n._onResult(Q(r,H))}),s),resultTimeout:i.setTimeout((function(){n._onResult(Q(r,j))}),o),resolve:e})}));return t.postMessage({type:"command",id:r,data:e},l||[]),a}))},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then((function(t){t.postMessage({type:"notification",data:e})}))},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then((function(t){e.postMessage({type:"result",data:t,id:n})})).catch((function(e){}))},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,r=this._signals,i=r.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),r.delete(t)},e}();function Q(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}const Y={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let q;const Z=new Uint8Array(16);function $(){if(!q&&(q="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!q))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return q(Z)}const ee=[];for(let et=0;et<256;++et)ee.push((et+256).toString(16).slice(1));function te(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return ee[e[t+0]]+ee[e[t+1]]+ee[e[t+2]]+ee[e[t+3]]+"-"+ee[e[t+4]]+ee[e[t+5]]+"-"+ee[e[t+6]]+ee[e[t+7]]+"-"+ee[e[t+8]]+ee[e[t+9]]+"-"+ee[e[t+10]]+ee[e[t+11]]+ee[e[t+12]]+ee[e[t+13]]+ee[e[t+14]]+ee[e[t+15]]}const ne=function(e,t,n){if(Y.randomUUID&&!t&&!e)return Y.randomUUID();const r=(e=e||{}).random||(e.rng||$)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return te(r)};var re,ie=((re={}).SHAREPOINT_TOKEN="SPO",re);var oe=function(){this.playState=new M(void 0),this.isPlayerReady=new M(!1),this.lastUserAction=new U,this.currentTimeInSeconds=new M(void 0),this.muted=new M(void 0),this.volume=new M(void 0),this.mediaDurationInSeconds=new M(void 0),this.playbackSpeed=new M(void 0),this.title=new M(void 0),this.itemUrl=new M(void 0),this.playerBeforeUnload=new U},ae=function(){function e(e,t,n,r,i){var o=this;this._ttlMs=new M(void 0),this._ttirMs=new M(void 0),this._playerInteractiveTimestamp=new M(void 0),this._pbsid=new M(void 0),this._latestValuesFromIframe={playState:void 0,currentTime:void 0,muted:void 0,volume:void 0,playbackSpeed:void 0},this.crossWindow=e,this._tokenRetriever=t,this._embedUrl=n,this._onError=r,this._onTitleOrDisplayNameUpdate=i,this.externalPlayerApi=new oe,this.playerStats={ttlMs:this._ttlMs,ttirMs:this._ttirMs,playerInteractiveTimestamp:this._playerInteractiveTimestamp,playbackSessionId:this._pbsid},this.subscribeToApiEvents(),window.addEventListener("beforeunload",(function(){o.externalPlayerApi.playerBeforeUnload.notify(!0)}))}return e.prototype.warmData=function(){return this.crossWindow.sendCommand({command:"one-player-warm-data"}).then((function(){return Promise.resolve()})).catch((function(e){throw A.createGenericError("warning","warmData","warmDataUnknown",e)}))},e.prototype.loadPlayer=function(e){return this.crossWindow.sendCommand({command:e?"one-player-load-player-auto-play":"one-player-load-player"}).then((function(){return Promise.resolve()})).catch((function(e){throw A.createGenericError("fatal","loadPlayer","loadPlayerUnknown",e)}))},e.prototype.onCommand=function(e){if("getToken"===e.command)return function(e,t,n){return(0,C.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,C.__generator)(this,(function(l){switch(l.label){case 0:if(!Object.prototype.hasOwnProperty.call(ie,e.tokenType))return[3,4];r=e.tokenType,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t.getTokenAsync(ie[r],n)];case 2:return[2,{result:"success",token:l.sent()}];case 3:return i=l.sent(),o="",a="","object"===typeof i&&null!==i&&(s=i,o=Object.prototype.hasOwnProperty.call(s,"code")&&"string"===typeof s.code?s.code:"",a=Object.prototype.hasOwnProperty.call(s,"message")&&"string"===typeof s.message?s.message:""),[2,{result:"error",isExpected:!1,error:{code:o,message:a}}];case 4:return[2,{result:"error",isExpected:!1,error:{code:"UnsupportedTokenType",message:"Unsupported token type"}}]}}))}))}(e,this._tokenRetriever,this._embedUrl)},e.prototype.onNotification=function(e){switch(void 0===this._pbsid.value&&void 0!==e.pbsid&&(this._pbsid.value=e.pbsid),e.notification){case"one-player-duration":this.externalPlayerApi.mediaDurationInSeconds.value=e.durationInSeconds;break;case"one-player-volume":this._latestValuesFromIframe.volume=e.volume,this.externalPlayerApi.volume.value=e.volume;break;case"one-player-muted":this._latestValuesFromIframe.muted=e.isMuted,this.externalPlayerApi.muted.value=e.isMuted;break;case"one-player-current-time":this._latestValuesFromIframe.currentTime=e.currentTime,this.externalPlayerApi.currentTimeInSeconds.value=e.currentTime;break;case"one-player-playback-speed":this._latestValuesFromIframe.playbackSpeed=e.playbackSpeed,this.externalPlayerApi.playbackSpeed.value=e.playbackSpeed;break;case"one-player-first-interactive":void 0!==e.timestamp&&void 0!==e.timestampTimeOrigin&&(this._playerInteractiveTimestamp.value={timestamp:e.timestamp,timeOrigin:e.timestampTimeOrigin});break;case"one-player-player-ready":this.externalPlayerApi.isPlayerReady.value=!0===e.isReady,void 0!==e.ttlMs&&(this._ttlMs.value=e.ttlMs);break;case"one-player-play-state":var t="Playing"===e.playState?"Playing":"Paused";this._latestValuesFromIframe.playState=t,this.externalPlayerApi.playState.value=t,void 0!==e.ttirMs&&(this._ttirMs.value=e.ttirMs);break;case"one-player-fatal-playback-error":this._onError(e.onePlayerError||A.createGenericError("fatal","playback","playbackUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-fatal-create-session-error":this._onError(e.onePlayerError||A.createGenericError("fatal","createSession","createSessionUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-reconnect-host":this.loadAndConnectToOnePlayerCallback(this).catch((function(e){throw A.createGenericError("fatal","requestReconnect","errorReconnecting",e)}));break;case"one-player-user-click-play":this.externalPlayerApi.lastUserAction.notify({action:"Play"});break;case"one-player-user-click-pause":this.externalPlayerApi.lastUserAction.notify({action:"Pause"});break;case"one-player-user-begin-seek":this.externalPlayerApi.lastUserAction.notify({action:"BeginSeek"});break;case"one-player-user-end-seek":if(void 0===e.targetTimeInSeconds)return void this._onError(A.createGenericError("warning","notification","targetTimeInSecondsUndefinedInEndSeekEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"EndSeek",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-user-skip":if(void 0===e.targetTimeInSeconds)return void this._onError(A.createGenericError("warning","notification","targetTimeInSecondsUndefinedInSkipEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"Skip",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-title-updated":this._onTitleOrDisplayNameUpdate(e.title),this.externalPlayerApi.title.value=e.title;break;case"one-player-item-url":this.externalPlayerApi.itemUrl.value=e.itemUrl;break;case"one-player-title-or-display-name-known":this._onTitleOrDisplayNameUpdate(e.value)}},e.prototype.subscribeToApiEvents=function(){var e=this;this.externalPlayerApi.playState.subscribe((function(t){t&&t!==e._latestValuesFromIframe.playState&&e.crossWindow.sendCommand({command:"Paused"===t?"one-player-pause":"one-player-play"}).catch((function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send play/pause command"))}))})),this.externalPlayerApi.currentTimeInSeconds.subscribe((function(t){void 0!==t&&t!==e._latestValuesFromIframe.currentTime&&e.crossWindow.sendCommand({command:"one-player-seek",position:t}).catch((function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send seek command"))}))})),this.externalPlayerApi.muted.subscribe((function(t){t!==e._latestValuesFromIframe.muted&&e.crossWindow.sendCommand({command:t?"one-player-mute":"one-player-unmute"}).catch((function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send mute/unmute command"))}))})),this.externalPlayerApi.volume.subscribe((function(t){t!==e._latestValuesFromIframe.volume&&e.crossWindow.sendCommand({command:"one-player-set-volume",volumeLevel:t}).catch((function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send set-volume command"))}))})),this.externalPlayerApi.playbackSpeed.subscribe((function(t){t!==e._latestValuesFromIframe.playbackSpeed&&e.crossWindow.sendCommand({command:"one-player-set-playback-speed",playbackSpeed:t}).catch((function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send set-playback-speed command"))}))}))},e}(),se=function(){function e(e,t,n,r,i){if(this._channelId=ne(),this._onError=r,this._onTitleOrDisplayNameUpdate=i,null===t.contentWindow)throw new Error("The iframe's contentWindow is null");var o=window.location.origin&&"null"!==window.location.origin?window.location.origin:"*",a=new URL(e);a.hash="#channelId="+this._channelId+"&origin="+o,this._embedUrl=a.toString(),this._host=function(e,t){void 0===t&&(t={});var n=e.channelId,r=e.onReinitialize,i=e.origin,o=e.receiver,a=void 0===o?window:o,s=e.source,l=e.identifyParent,c=t.eventGroupType,d=void 0===c?N:c,u=t.messengerType,p=void 0===u?J:u,h=new D,m=h.attach(new d(null));return new p({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var o;if(l&&s){var c=setInterval((function(){var e={type:"identify-parent",channelId:n};s.postMessage(e,i)}),100);o=h.attach({dispose:function(){clearInterval(c)}})}var d=!1;m.on(a,"message",(function(t){var a=t.data;if(t.origin===i&&(!s||t.source===s)&&a&&"object"===typeof a&&"initialize"===a.type&&a.channelId===n){if(o&&o.dispose(),r){if(d)return r(),void m.dispose();d=!0}else m.dispose();var l=a.replyTo;l.postMessage({type:"activate"}),e(l)}}))},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({identifyParent:!0,source:t.contentWindow,channelId:this._channelId.toString(),origin:new URL(e).origin,initTimeoutMs:4e4,onCommand:this.onCommand.bind(this),onNotification:this.onNotification.bind(this)}),this._tokenRetriever=n}return e.prototype.createIframeApi=function(){this.iFrameApi=new ae(this._host,this._tokenRetriever,this._embedUrl,this._onError,this._onTitleOrDisplayNameUpdate),this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},e.prototype.reconnectHost=function(e){e.crossWindow=this._host,this.iFrameApi=e,this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},e.prototype.getDecoratedEmbedUrl=function(){return this._embedUrl},e.prototype.dispose=function(){this._host.dispose()},e.prototype.onCommand=function(e){return this._onCommandCallback(e)},e.prototype.onNotification=function(e){this._onNotificationCallback(e)},e}();function le(e,t,n){return new Promise((function(r,i){e.onload=function(){r()},e.onerror=function(e){i(e)};var o=e.contentDocument;o.body||o.createElement("body");var a=o.createElement("form");a.action=t,a.method="POST",a.style.visibility="hidden",a.target="_self";var s=o.createElement("input");s.type="hidden",s.name="access_token",s.value=n,a.appendChild(s),o.body.appendChild(a),a.submit()}))}var ce=function(){function e(e,t,n,r,i){var o=this;this.observer=void 0,this.isIframeConnected=new M(!1),this.defaultIframeTitle="Microsoft Stream video and audio player",this._hasNavigatedToAboutBlank=!1,this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",i&&(this._iframe.allowFullscreen=!0),this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups"),this._iframe.setAttribute("title",this.defaultIframeTitle);var a=this.onLoad.bind(this);this._iframe.addEventListener("load",a),this._embedUrl=e,this._containerDiv=t,this._tokenRetriever=n,this._onError=r,this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe),this.observer=new MutationObserver((function(){var e,t,n;o.isIframeConnected.value=(null===(e=o._iframe)||void 0===e?void 0:e.isConnected)||!1,(null===(t=o._iframe)||void 0===t?void 0:t.isConnected)&&(null===(n=o.observer)||void 0===n||n.disconnect())})),this._disposeActions=[function(){var e;o._iframe&&(o._containerDiv.removeChild(o._iframe),o._iframe.removeEventListener("load",a),o._iframe=void 0),null===(e=o.observer)||void 0===e||e.disconnect()}]}return e.prototype.loadAndConnectToOnePlayer=function(e){return(0,C.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i=this;return(0,C.__generator)(this,(function(o){switch(o.label){case 0:if(void 0===this._iframe)throw new Error("Cannot load and connect to OnePlayer because the iframe has been disposed.");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._tokenRetriever.getTokenAsync("SPO",this._embedUrl)];case 2:return t=o.sent(),[3,4];case 3:throw n=o.sent(),A.createGenericError("fatal","loadIframe","getTokenFailed",n);case 4:return e&&this.reCreateIframeElement(),[4,this.waitForIframeConnected()];case 5:o.sent(),this._crossWindowChannel=new se(this._embedUrl,this._iframe,this._tokenRetriever,this._onError,(function(e){return i._onTitleOrDisplayNameUpdate(e)})),e?this._crossWindowChannel.reconnectHost(e):this._crossWindowChannel.createIframeApi(),this._disposeActions.push((function(){var e;return null===(e=i._crossWindowChannel)||void 0===e?void 0:e.dispose()})),this._embedUrl=this._crossWindowChannel.getDecoratedEmbedUrl(),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,le(this._iframe,this._embedUrl,t)];case 7:return o.sent(),[3,9];case 8:throw r=o.sent(),A.createGenericError("fatal","loadIframe","navToEmbed",r);case 9:return[2,this._crossWindowChannel.iFrameApi]}}))}))},e.prototype.dispose=function(){for(var e=0,t=this._disposeActions;e<t.length;e++){(0,t[e])()}this._disposeActions.length=0},e.prototype.reCreateIframeElement=function(){this._iframe&&(this.dispose(),this._hasNavigatedToAboutBlank=!1),this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups"),this._iframe.setAttribute("title",this.defaultIframeTitle);var e=this.onLoad.bind(this);this._iframe.addEventListener("load",e),this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe)},e.prototype.waitForIframeConnected=function(){return(0,C.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,C.__generator)(this,(function(t){return[2,new Promise((function(t){var n;if(null===(n=e._iframe)||void 0===n?void 0:n.isConnected)t();else{var r=e.isIframeConnected.subscribe((function(e){e&&t()}));e._disposeActions.push((function(){return r()}))}}))]}))}))},e.prototype.onLoad=function(){var e,t,n,r;try{"about:blank"!==(null===(t=null===(e=this._iframe)||void 0===e?void 0:e.contentWindow)||void 0===t?void 0:t.location.href)&&(null===(r=null===(n=this._iframe)||void 0===n?void 0:n.contentWindow)||void 0===r?void 0:r.location.href)||(this._hasNavigatedToAboutBlank&&this._onError(A.createGenericError("fatal","loadIframe","iframeForciblyUnloaded",void 0,void 0)),this._hasNavigatedToAboutBlank=!0)}catch(i){i instanceof DOMException&&(this._hasNavigatedToAboutBlank=!0)}},e.prototype._onTitleOrDisplayNameUpdate=function(e){var t;null===(t=this._iframe)||void 0===t||t.setAttribute("title",e||this.defaultIframeTitle)},e}(),de=function(){function e(e){this._loaderOptionsBase=e}return e.prototype.createPlaybackSession=function(e,t){return(0,C.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,C.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal(e?"autoplayOn":"autoplayOff",t)];case 1:return n=a.sent(),r=n[0],i=n[1],[2,{playbackApi:r.externalPlayerApi,dispose:i,playerStats:r.playerStats}];case 2:throw(o=a.sent())instanceof A?o:A.createGenericError("fatal","loadIframe","iframeUnknown",o,void 0,t.hostSessionId);case 3:return[2]}}))}))},e.prototype.createThumbnailHyperlinkOnlySession=function(e){return(0,C.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return(0,C.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("thumbnailHyperlinkOnly",e)];case 1:return t=o.sent(),n=t[0],r=t[1],[2,{playbackApi:n.externalPlayerApi,playerStats:n.playerStats,dispose:r,simulateClick:function(){return n.loadPlayer(!0)}}];case 2:return i=o.sent(),[2,Promise.reject(i)];case 3:return[2]}}))}))},e.prototype.createDeferredPlaybackSession=function(e){return(0,C.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o;return(0,C.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("deferredLoad",e)];case 1:return t=a.sent(),n=t[0],r=t[1],i=new M(void 0),n.externalPlayerApi.isPlayerReady.subscribe((function(e){e&&(i.value=n.externalPlayerApi)})),[2,{playbackApi:i,loadPlayer:function(e){return n.loadPlayer(e)},warmData:function(){return n.warmData()},dispose:r,playerStats:n.playerStats}];case 2:throw(o=a.sent())instanceof A?(o.hostSessionId=e.hostSessionId,o):A.createGenericError("fatal","loadIframe","iframeUnknown",o,void 0,e.hostSessionId);case 3:return[2]}}))}))},e.prototype.createPlaybackSessionInternal=function(e,t){return(0,C.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,l;return(0,C.__generator)(this,(function(c){switch(c.label){case 0:return n=performance.now(),r={timeOrigin:Date.now()-n,timestamp:n},[4,this.getEmbedUrlAsync(t.videoId.videoUrl)];case 1:return i=c.sent(),i=this.adjustEmbedUrlQueryString(e,i,t,r),o=void 0,a=function(){try{null===o||void 0===o||o.dispose()}catch(e){throw e instanceof A?e:A.createGenericError("fatal","dispose","disposeUnknown",e,void 0,t.hostSessionId)}},s=function(e){t.onError(a,e)},[4,(o=new ce(i,t.containerDiv,this._loaderOptionsBase.tokenRetriever,s,t.allowFullscreen)).loadAndConnectToOnePlayer()];case 2:return(l=c.sent()).loadAndConnectToOnePlayerCallback=o.loadAndConnectToOnePlayer.bind(o),[2,[l,a]]}}))}))},e}();const ue="13.17.11";var pe=function(e){function t(t){return e.call(this,t)||this}return(0,C.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,n,r){var i=new URL(t);i.searchParams.delete("access_token"),i.searchParams.set("auth","readwrite");var o=void 0,a=void 0,s=void 0;n.theme&&(o="light"===n.theme.name?1:0,a=n.theme.primaryColor,s=n.theme.fluentTheme);var l=JSON.stringify({af:"autoplayOn"===e?1:0,ap:"autoplayOn"===e?1:0,dl:"deferredLoad"===e?1:void 0,ha:n.hostApp,hp:n.hostPlatform,hv:n.hostView,hc:n.hostComponent,hci:n.hostCorrelationId,het:n.hostExtraTelemetry,hra:n.hostReferrerApp,hrp:n.hostReferrerAppPlatform,hrv:n.hostReferrerView,hrm:n.hostReferrerMode,hrps:n.hostReferrerPlaybackSessionId,hvn:n.hostVersion,he:n.hostEnvironment,hm:n.hostMode,hsi:n.hostSessionId,lv:ue,t0:n.hostTimestamps.t0.timestamp,t0to:n.hostTimestamps.t0.timeOrigin,tcs:r.timestamp,tcsto:r.timeOrigin,ust:o,pc:a,theme:s,ol:n.overrideLanguage,hvm:n.hideVideoMetadata,itf:n.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(i.searchParams.set("embed",l),n.startTimeInSeconds){var c={playbackOptions:{startTimeInSeconds:n.startTimeInSeconds}};i.searchParams.set("nav",JSON.stringify(c))}if(n.flightsUsed||n.flightsUnused){var d={flightsUsed:n.flightsUsed?n.flightsUsed.join(","):void 0,flightsUnused:n.flightsUnused?n.flightsUnused.join(","):void 0};i.searchParams.set("exp",JSON.stringify(d))}return i.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("embed.aspx"))return Promise.resolve(e);throw A.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0)},t}(de);var he=function(e){function t(t){return e.call(this,t)||this}return(0,C.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,n,r){var i,o,a,s=new URL(t);s.searchParams.delete("access_token"),s.searchParams.set("auth","readwrite");var l=JSON.stringify({ha:n.hostApp,hp:n.hostPlatform,hv:n.hostView,hm:n.hostMode,hsi:n.hostSessionId,he:n.hostEnvironment,hc:n.hostComponent,hci:n.hostCorrelationId,het:n.hostExtraTelemetry,hra:n.hostReferrerApp,hrp:n.hostReferrerAppPlatform,hrv:n.hostReferrerView,hrm:n.hostReferrerMode,hrps:n.hostReferrerPlaybackSessionId,hvn:n.hostVersion,lv:ue,t0:n.hostTimestamps.t0.timestamp,t0to:n.hostTimestamps.t0.timeOrigin,tcs:r.timestamp,tcsto:r.timeOrigin,dl:"deferredLoad"===e?1:void 0,af:"autoplayOn"===e?1:void 0,ap:"autoplayOn"===e?1:void 0,thl:"thumbnailHyperlinkOnly"===e?1:void 0,thm:null===(i=n.theme)||void 0===i?void 0:i.name,pc:null===(o=n.theme)||void 0===o?void 0:o.primaryColor,flthm:null===(a=n.theme)||void 0===a?void 0:a.fluentTheme,ol:n.overrideLanguage,hvm:n.hideVideoMetadata,itf:n.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(s.searchParams.set("embed",l),n.startTimeInSeconds){var c={playbackOptions:{startTimeInSeconds:n.startTimeInSeconds}};s.searchParams.set("nav",JSON.stringify(c))}if(n.flightsUsed||n.flightsUnused){var d={flightsUsed:n.flightsUsed?n.flightsUsed.join(","):void 0,flightsUnused:n.flightsUnused?n.flightsUnused.join(","):void 0};s.searchParams.set("exp",JSON.stringify(d))}return s.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("streamembed.aspx"))return Promise.resolve(e);throw A.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0,void 0)},t}(de);var me=n(77482),fe=n(26934);const ve={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGE_CHROMIUM:"Edge Chromium",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",OPERA:"Opera"},ye="Windows",be="Mac OS X",ge="Windows Phone",_e="Windows RT",we="iOS",ke="Android",Ee="Linux",Pe=/(windows|win32)/i,Se=/ arm;/i,Te=/windows\sphone\s\d+\.\d+/i,Ie=/(macintosh|mac os x)/i,Ae=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,Ce=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,Oe=/android/i,Ue={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Me="([\\d,.]+)",Re="Unknown",xe="undefined";function De(e,t){return t.indexOf(e)>-1}function Ne(e,t){if(t===ve.MSIE)return function(e){const t=e.match(new RegExp(ve.MSIE+" "+Me));if(t)return t[1];{const t=e.match(new RegExp("rv:"+Me));if(t)return t[1]}return""}(e);return function(e,t){let n=e;n===ve.SAFARI&&(n="Version");const r=t.match(new RegExp(n+"/"+Me));if(r)return r[1];return}(t===ve.EDGE_CHROMIUM?"Edg":t,e)}const Fe=e=>e.match(Te)?ge:e.match(Se)?_e:e.match(Ae)?we:e.match(Oe)?ke:e.match(Ce)?Ee:e.match(Ie)?be:e.match(Pe)?ye:Re,Le=(e,t)=>t===ye?Ve(e,"Windows NT"):t===ke?Ve(e,t):t===be?We(e):Re,Ve=(e,t)=>{const n=e.match(new RegExp(t+" "+Me));return n?Ue[n[1]]?Ue[n[1]]:n[1]:Re},We=e=>{const t=e.match(new RegExp(be+" ([\\d,_,.]+)"));if(t){const e=t[1].replace(/_/g,".");if(e){const t=(e=>e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null)(e);if(t){return e.split(t)[0]}return e}}return Re};let Ge;function He(){if(!Ge){const e=typeof navigator!==xe?navigator.userAgent:"",t=function(e){return De("OPR/",e)?ve.OPERA:De(ve.PHANTOMJS,e)?ve.PHANTOMJS:De(ve.EDGE,e)?ve.EDGE:De("Edg",e)?ve.EDGE_CHROMIUM:De(ve.ELECTRON,e)?ve.ELECTRON:De(ve.CHROME,e)?ve.CHROME:De("Trident",e)?ve.MSIE:De(ve.FIREFOX,e)?ve.FIREFOX:De(ve.SAFARI,e)?ve.SAFARI:De(ve.SKYPE_SHELL,e)?ve.SKYPE_SHELL:void 0}(e),n=void 0!==t?Ne(e,t):void 0,r=Fe(e),i=void 0!==r?Le(e,r):void 0;Ge={browserName:t,browserVersion:n,osName:r,osVersion:i}}return Ge}const je=()=>"undefined"===typeof window,ze=()=>{var e;return!(null===(e=window.chrome)||void 0===e||!e.webview)};function Be(){const{osName:e}=He();return function(e){if(je()||ze())switch(e){case"Android":return"Android";case"iOS":return"iOS";case"Linux":return"Linux";case"Mac OS X":return"Mac";case"Windows":return"Win32";default:return}return"Web"}(e)}function Ke(e){var t;const n=function(e){var t;let n,r=null!==(t=Be())&&void 0!==t?t:"Native";switch(e){case fe.l.ExchangeAppId:case fe.l.MonarchAppId:case fe.l.OwaAppId:n=fe.F.Outlook,ze()&&(r="Desktop");break;case fe.l.OfficeAppId:n="Win32"===r?fe.F.Outlook:fe.F.LoopApp;break;case fe.l.LoopAppId:n=fe.F.LoopApp}return{hostApp:n,hostPlatform:r}}(e),r=n.hostPlatform||"";return n.hostApp===fe.F.LoopApp?{hostApp:"Loop",hostPlatform:r}:{hostApp:null!==(t=n.hostApp)&&void 0!==t?t:e,hostPlatform:r}}var Xe=n(82519);function Je(e){return t=>{"Playing"===t?e.raiseIsPlaying():"Paused"===t&&e.raiseIsPaused()}}async function Qe(e,t,n,r,i,o,a){var l,c,d,u,p,h,v;let y=arguments.length>7&&void 0!==arguments[7]&&arguments[7],b=arguments.length>8?arguments[8]:void 0,g=arguments.length>9?arguments[9]:void 0,_=arguments.length>10?arguments[10]:void 0;const{hostApp:P,hostPlatform:S}=Ke(null!==(l=n.AppID)&&void 0!==l?l:""),T=f(r),I=await async function(e,t){return{tokenRetriever:{beginSilentSignOn:()=>{},getTokenAsync:async(n,r)=>{let i=[];try{null===t||void 0===t||t.markSubActivityStart(m.u.OnePlayerTokenRetrieval);const n=w.v.SharePoint;i=(0,k.B)((0,E.P)(r),n);const o=await e.TokenProvider.getToken(i);return null===t||void 0===t||t.markSubActivityEnd(m.u.OnePlayerTokenRetrieval),o.token}catch(o){throw null===t||void 0===t||t.markSubActivityEnd(m.u.OnePlayerTokenRetrieval,{[s.KF.OnePlayerTokenRetrieval]:"failed",tokenType:n}),o}}}}}(n,T),C=r.additionalTelemetryProperties.unfurlCorrelationId,O=r.additionalTelemetryProperties.variableTimeOrigin,U=(M=r.settingsProvider,(0,Xe.kL)(M)?"P-X-1112345-4":(0,Xe.Wp)(M)?"P-X-1112345-2":(0,Xe.ps)(M)?"P-X-1112345-1":"P-X-1112345-3");var M;const R=null===(c=r.telemetryConfig)||void 0===c?void 0:c.scenarioStartTime,x=b&&(null===(d=b.PersistedProperties)||void 0===d||null===(u=d.getPersistedProperties)||void 0===u?void 0:u.call(d).hostScenarioStartTime),D=b&&(null===(p=b.PersistedProperties)||void 0===p||null===(h=p.getPersistedProperties)||void 0===h?void 0:h.call(p).codeVersion),N=function(e,t,n,r,i){if(t)return performance.now();if(e){const e=null!==r&&void 0!==r?r:i;if(void 0!==e){const t=Date.now()-e;return performance.now()-t}}return null!==n&&void 0!==n?n:performance.now()}((0,Xe.NE)(r.settingsProvider),y,null===T||void 0===T?void 0:T.startTime,"number"===typeof x?x:void 0,R);null===T||void 0===T||T.addAdditionalProps({unfurlCorrelationId:C,isVideoHydratedInDetachedMode:y,t0TimeOrigin:O,t0:N,telemetryConfigScenarioStartTime:R,loggerScenarioStartTime:x,usedOnePlayerIframeConfigId:U});const F={videoId:{videoUrl:(0,Xe.Wp)(r.settingsProvider)?t:t.replace("embed.aspx","streamembed.aspx")},containerDiv:e,allowFullscreen:!1,onError:o,hostApp:P,hostPlatform:S,hostComponent:me._,hostView:null!==g&&void 0!==g?g:"",theme:i,hostSessionId:(null===(v=r.telemetryConfig)||void 0===v?void 0:v.hostSessionId)||"",hostCorrelationId:C||"",hostMode:void 0,hostEnvironment:"Prod",hostTimestamps:{t0:{timestamp:N,timeOrigin:O}},hostVersion:"string"===typeof D?D:"",overrideLanguage:a,enableVideoPlayerTabstopDuringPlayback:!1,flightsUsed:[U],startTimeInSeconds:_};null===T||void 0===T||T.markSubActivityEnd(m.u.TimeInPlaybackLoopComponent);const L=function(e,t){return(0,Xe.Wp)(t)?function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new pe(e)}catch(n){throw n instanceof A?n:A.createGenericError("fatal","loadIframe",t,n)}}(e):function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new he(e)}catch(n){throw n instanceof A?n:A.createGenericError("fatal","loadIframe",t,n)}}(e)}(I,r.settingsProvider);return await function(e,t,n){return(0,Xe.kL)(n)||(0,Xe.Wp)(n)?e.createPlaybackSession(!1,t):(0,Xe.ps)(n)?e.createThumbnailHyperlinkOnlySession(t):e.createDeferredPlaybackSession(t)}(L,F,r.settingsProvider)}class Ye{cleanUp(){this.playState.unsubscribeAll()}constructor(e){this.isPlayerReady=new M(!1),this.playState=new M("Paused"),this.lastUserAction=new M({action:"Pause"}),this.currentTimeInSeconds=new M(void 0),this.muted=new M(void 0),this.volume=new M(void 0),this.mediaDurationInSeconds=new M(void 0),this.playbackSpeed=new M(void 0),this.title=new M(void 0),this.itemUrl=new M(void 0),this.playState.subscribe((t=>{"Playing"===t&&e.loadPlayer(!0).catch((e=>{throw e}))}))}}const qe={dark:"dark",light:"light",default:"light"};function Ze(e){if(e.current){return getComputedStyle(e.current).getPropertyValue(_.L7)||void 0}}const $e=e=>{let{embeddableUrl:t,playbackStateSetter:n,parentRef:p,setViewRootElement:w,endRenderingActivity:k,onKeyDownHandler:E,setIsPlayerReady:P,setError:S,updateTitle:T,strings:I,hostView:A,startTimeInSeconds:C}=e;const O=(0,c.w)(),U=(0,d.I)(),M=(0,u.j)(),R=r.useRef(null),x=r.useRef(null),D=r.useRef(null),N=r.useRef(null),F=r.useRef(void 0),[L,V]=r.useState(!1),W=(0,i.u)(),G=function(e){const t=(0,i.u)(),[n,o]=r.useState();return r.useEffect((()=>{const r=qe[(null===t||void 0===t?void 0:t.themeName)||"light"];e.current&&(null===n||void 0===n?void 0:n.name)!==r&&o({name:r,primaryColor:Ze(e)})}),[t,e,null===n||void 0===n?void 0:n.name]),n}(R),H=(0,o.bU)(),j=r.useMemo(h,[]),z=!(0,Xe.Wp)(U.settingsProvider)&&!(0,Xe.kL)(U.settingsProvider)&&!(0,Xe.ps)(U.settingsProvider),B=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[n,i]=r.useState(!1),o=r.useRef(),l=(0,c.w)();return r.useEffect((()=>{if(!t)return;const e=new IntersectionObserver((e=>{i(e[0].isIntersecting)}));return o.current=e,()=>e.disconnect()}),[t]),r.useEffect((()=>{if(!t)return;const n=e.current;if(n){if(o.current){const e=o.current;return e.observe(n),()=>e.unobserve(n)}return()=>{}}(0,a.S)(void 0,l,"useVisibilityObserver",s.KF.MissingVisibilityElement)}),[e,l,t]),{observer:o,isVisible:n}}(p,z),K=function(e){const[t,n]=r.useState(null),i=r.useRef(null),[o,a]=r.useState(void 0);r.useEffect((()=>{n(e.current)}),[e]);const s=()=>{var e;null===(e=i.current)||void 0===e||e.disconnect()};return r.useEffect((()=>{if(t&&(s(),a((()=>t.isConnected)),!t.isConnected))return i.current=new MutationObserver((()=>{a((()=>t.isConnected)),t.isConnected&&s()})),i.current.observe(document.body,{subtree:!0,childList:!0}),()=>{s()}}),[t]),o}(R),X=(0,Xe.zS)(U.settingsProvider)&&K,J=r.useCallback((e=>{const t=f(U);t&&e&&(null===P||void 0===P||P(!0),j.setIsReady(t,{playerInteractiveTimestamp:e},U.additionalTelemetryProperties.variableTimeOrigin))}),[U,j,P]),Q=r.useCallback((e=>{if((e=>v.includes(e.key))(e)){e.preventDefault(),e.stopPropagation();const t=N.current;if(t&&g(t))return void(F.current?window.open(F.current,"_blank","noopener,noreferrer"):(D.current={...D.current,itemUrlUnsubscribe:t.playbackApi.itemUrl.subscribe((e=>{e&&(F.current=e,window.open(e,"_blank","noopener,noreferrer"))}))},t.simulateClick()));"Playing"===n.getPlaybackState()?n.pause():n.play()}else(e=>y.includes(e.key))(e)||E(e)}),[n,E]),Y=r.useCallback((()=>{(0,_.X6)(p.current,(0,Xe.d_)(U.settingsProvider))}),[p,U]),q=r.useCallback((()=>{(0,_.hN)(p.current,(0,Xe.d_)(U.settingsProvider))}),[p,U]),Z=r.useCallback((e=>{n.initialize(e),D.current={...D.current,playStateUnsubscribe:e.playState.subscribe(Je(n)),titleUnsubscribe:e.title.subscribe(T)}}),[n,T]);return r.useEffect((()=>{if(!N.current)return;const e=N.current;var t;b(e)&&B.isVisible&&p.current&&(null===(t=B.observer.current)||void 0===t||t.unobserve(p.current),e.warmData().catch((e=>{(0,a.S)(e,O,"warmData",s.KF.OnePlayerWarmup)})))}),[B,O,p,L]),r.useEffect((()=>{const e=f(U),r=(t,n)=>{null===P||void 0===P||P(!0);const{level:r,isExpected:o,scenario:a,knownError:c,playbackSessionId:d}=n;"iframeForciblyUnloaded"===c?(N.current=null,t(),null===e||void 0===e||e.markSubActivityStart(m.u.SetupIframeAfterIframeForciblyUnloaded),i(),null===e||void 0===e||e.markSubActivityEnd(m.u.SetupIframeAfterIframeForciblyUnloaded)):(k(l.G.Embedded),null===e||void 0===e||e.setResult(!1,{errorCode:s.KF.IframePlayerSetup,level:r,scenario:a,isExpected:o,playbackSessionId:d},c),"loadIframe"===a&&S&&S(new Error("loadIframe failed")))};function i(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((0,Xe.zS)(U.settingsProvider)){if(null===R.current||void 0===G||!X)return}else{if(null===R.current||void 0===G)return;if(!R.current.isConnected)return void function(e,t,n){null===n||void 0===n||n.markSubActivityStart(m.u.VideoHydratedInDetachedMode);const r=document.createElement("iframe");r.height="0px",r.width="0px",r.style.visibility="hidden";const i=()=>{e.removeChild(r),null===n||void 0===n||n.markSubActivityEnd(m.u.VideoHydratedInDetachedMode),t(!0),document.removeEventListener("load",i),document.removeEventListener("error",i)};r.addEventListener("load",i),r.addEventListener("error",i),e.appendChild(r)}(R.current,i,e)}Qe(R.current,t,M,U,G,r,H,o,O,A,C).then((e=>{if(k(l.G.Embedded),N.current=e,V(!0),w(x.current),D.current={playerStatsPlayerInteractiveTimestampUnsubscribe:e.playerStats.playerInteractiveTimestamp.subscribe(J)},b(e)){const t=new Ye(e);n.initialize(t),D.current={...D.current,playbackApiUnsubscribe:e.playbackApi.subscribe((e=>{e&&(t.cleanUp(),Z(e))}))}}else g(e)||Z(e.playbackApi)})).catch((t=>{null===P||void 0===P||P(!0),k(l.G.Embedded);const n=(e=>{const t=e=>"object"===typeof e&&null!==e;let n=e;if(t(e)&&"string"!==typeof e.message){const r=e.originalError;"string"===typeof r?n={...e,message:r}:t(r)&&"string"===typeof r.message&&(n={...e,message:r.message})}return n})(t);null===e||void 0===e||e.setResult(!1,{errorCode:s.KF.IframePlayerSetup},n),(0,a.S)(n,O,"setupIframePlayer",s.KF.IframePlayerSetup)}))}return i(),()=>{var e,t;if(D.current&&(t=D.current,Object.values(t).forEach((e=>e()))),null===(e=N.current)||void 0===e||e.dispose(),R.current){const e=R.current;for(;e.firstChild&&e.lastChild;)e.removeChild(e.lastChild)}}}),[X,t,M,O,U,n,k,G,w,J,j,Q,H,Z,P,S,A,C]),r.createElement(r.Fragment,null,r.createElement("div",{ref:x,role:"link",tabIndex:0,onFocus:Y,onBlur:q,onKeyDown:Q,"aria-label":I.onePlayerIframeHostContainerAriaLabel}),r.createElement("div",{ref:R,className:(0,_.Cu)(null===W||void 0===W?void 0:W.theme.palette.themePrimary),"aria-label":I.onePlayerIframeHostContainerAriaLabel}))}}}]);
//# sourceMappingURL=StreamEmbeddedRenderer.a9cb848e.chunk.js.map